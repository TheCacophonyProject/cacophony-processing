dist: bionic
language: python
python:
- '3.9'
install:
- python -m pip install --upgrade pip
- pip install -r requirements.txt
- pip install black --upgrade
script:
- pytest
before_deploy:
- "pip install pex==2.1.90"
- mkdir -p /tmp/x
- curl -sL https://github.com/goreleaser/nfpm/releases/download/v0.9.5/nfpm_0.9.5_Linux_x86_64.tar.gz
  | tar -C /tmp/x -xzf -
- PATH=/tmp/x:$PATH _release/build ${TRAVIS_TAG}
deploy:
  provider: releases
  api_key:
    secure: e9vLA+hL6Ie60tVxcFVJXWsHhUbT96xgJBHi9HwIpcvRusGKEJx3Vmh+TGSP4H7+FTvCnEAwv09EGo4QyWauf7NZMvg0xzfvmWUn0IcNITW/XH1XJMCBYVaQmDUJ2Krp7xuTHAnYV0vz7Z8uzNRsjvGBqAutt0r/u5KsR1C/u9vn9NL/TDG/w1b8gHmQ2c9H40pc+Q5nlokMjYL1RVQXvng3iU/jIwQvhpqdOSCZXsRFfDxPb0gDN0asSN9yyDcCRQSIe0rXE/oaQmxXcaIdY9uB+WjN9vj7haJP3BGAiUZqQGXl35hjZgp+OXSN/+I6bA53AiQ2aC+8ihhMinO7Ni01zmADc6zUBBZAut0CeN56veO0J9viFBuSX+G1Wvd+8CuTSZQHFU/nqV7qtVriOC92yitpyi10mDeuK0bAzDcxxdFM6GhsjPtih5W+RlOS7DIggpLfVdPC2+2H4tp/IaXtJYD33gYxH0ka8EJG5Nzs1+qHwUgC+JRe8KHfYDx+xTnCYXbss7fHqxtAPA930T2jeZxXlyVGgT59Zs/sXTsO0i1G0O9BwwCOxDdinwb6mlV2vxG2ZVCm6G2lGX3DBKwwiA23peHjBZk62Eqf/1zOSZMrgO1o3gVjto3pB5mfFZ7V3YGCjFNjYOzRJs84O17XGWZHAfZcAXF6Kshuxg0=
  skip_cleanup: true
  file_glob: true
  file: "build/*.deb"
  on:
    repo: TheCacophonyProject/cacophony-processing
    tags: true
